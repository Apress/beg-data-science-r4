## -----------------------------------------------------------------------------
1 + 2
4 / 2
(2 + 2) * 3


## -----------------------------------------------------------------------------
4 / 3


## -----------------------------------------------------------------------------
class(4)
class(4L)


## -----------------------------------------------------------------------------
4 %/% 3


## -----------------------------------------------------------------------------
4 %% 3


## -----------------------------------------------------------------------------
2 ^ 2
2 ** 2
2 ^ 3
2 ** 3


## -----------------------------------------------------------------------------
"Hello,"
'world!'


## -----------------------------------------------------------------------------
x <- 2


## -----------------------------------------------------------------------------
x


## -----------------------------------------------------------------------------
2 * x


## -----------------------------------------------------------------------------
2 -> x


## -----------------------------------------------------------------------------
x <- "invisible"
(y <- "visible")


## ---- echo=FALSE--------------------------------------------------------------
rm(x)
rm(y)


## -----------------------------------------------------------------------------
1:50


## -----------------------------------------------------------------------------
-1:1
0.1:2.9


## -----------------------------------------------------------------------------
seq(.1, .9, .2)


## -----------------------------------------------------------------------------
length("qax")
length("quux")
length(c("foo", "bar"))


## -----------------------------------------------------------------------------
c("foo", "bar")


## -----------------------------------------------------------------------------
nchar("qax")
nchar("quux")
nchar(c("foo", "bar"))


## -----------------------------------------------------------------------------
paste("foo", "bar", sep = "")


## -----------------------------------------------------------------------------
paste("foo", "bar")


## -----------------------------------------------------------------------------
(v <- 1:5)
v[1]
v[3]


## -----------------------------------------------------------------------------
v[1:3]
v[c(1,3,5)]


## -----------------------------------------------------------------------------
v[c(TRUE, FALSE, TRUE, FALSE, TRUE)]


## -----------------------------------------------------------------------------
v %% 2 == 0
v[v %% 2 == 0]


## -----------------------------------------------------------------------------
v[-(1:3)]


## -----------------------------------------------------------------------------
v <- c("A" = 1, "B" = 2, "C" = 3)
v
v["A"]
names(v) <- c("x", "y", "z")
v
v["x"]


## ---- echo=FALSE--------------------------------------------------------------
rm(v)


## -----------------------------------------------------------------------------
x <- 1:3 ; y <- 4:6
x ** 2 - y


## -----------------------------------------------------------------------------
(x <- 1:3)
x ** 2
y <- 6:8
x ** 2 - y


## -----------------------------------------------------------------------------
(x <- 1:4)
(y <- 1:2)
x - y


## -----------------------------------------------------------------------------
(x <- 1:4)
(y <- 1:3)
x - y


## ---- echo=FALSE--------------------------------------------------------------
rm(x)
rm(y)


## -----------------------------------------------------------------------------
square <- function(x) x**2
square(2)
square(1:4)


## -----------------------------------------------------------------------------
square_and_subtract <- function(x, y) {
    squared <- x ** 2
    squared - y
}
square_and_subtract(1:5, rev(1:5))


## -----------------------------------------------------------------------------
square_and_subtract <- function(x, y) x ** 2 - y


## -----------------------------------------------------------------------------
square_and_subtract <- function(x, y) return(x ** 2 - y)


## ---- echo=FALSE--------------------------------------------------------------
rm(square)
rm(square_and_subtract)


## -----------------------------------------------------------------------------
sum(1:4)


## -----------------------------------------------------------------------------
average <- function(x) {
    n <- length(x)
    sum(x) / n
}
average(1:5)


## -----------------------------------------------------------------------------
average <- function(x) sum(x) / length(x)


## ---- echo=FALSE--------------------------------------------------------------
rm(average)


## -----------------------------------------------------------------------------
mean_and_sd <- function(x) c(mean = mean(x), sd = sd(x))
mean_and_sd(1:10)


## ---- echo=FALSE--------------------------------------------------------------
rm(mean_and_sd)


## -----------------------------------------------------------------------------
normalise <- function(x) (x - mean(x)) / sd(x)
normalise(1:10)


## ---- echo=FALSE--------------------------------------------------------------
rm(normalise)


## -----------------------------------------------------------------------------
# this won't do anything
if (2 > 3) "false"


## -----------------------------------------------------------------------------
# this will
if (3 > 2) "true"


## -----------------------------------------------------------------------------
x <- "foo"
if (2 > 3) x <- "bar"
x
if (3 > 2) x <- "baz"
x


## -----------------------------------------------------------------------------
if (2 > 3) "bar" else "baz"


## -----------------------------------------------------------------------------
if (3 > 2)
    x <- "bar"
x


## -----------------------------------------------------------------------------
if (2 > 3) {
    x <- "bar"
} else 
    x <- "qux"
x


## -----------------------------------------------------------------------------
if (2 > 3) 
    x <- "bar"
else 
    x <- "qux"


## -----------------------------------------------------------------------------
if (2 > 3) "bar" else "baz"


## -----------------------------------------------------------------------------
x <- if (2 > 3) "bar" else "baz"
x


## -----------------------------------------------------------------------------
x <- if (2 > 3) { "bar" } else { "baz" }
x


## -----------------------------------------------------------------------------
x <- 1:5
if (x > 3) "bar" else "baz"


## -----------------------------------------------------------------------------
x <- 1:5
ifelse(x > 3, "bar", "baz")


## -----------------------------------------------------------------------------
maybe_square <- function(x) {
    if (x %% 2 == 0) x ** 2 else x
}
maybe_square(1:5)


## -----------------------------------------------------------------------------
maybe_square <- function(x) {
    ifelse(x %% 2 == 0, x ** 2, x)
}
maybe_square(1:5)


## -----------------------------------------------------------------------------
maybe_square <- function(x) {
    if (x %% 2 == 0) x ** 2 else x
}
maybe_square <- Vectorize(maybe_square)
maybe_square(1:5)


## -----------------------------------------------------------------------------
x <- 1:5
total <- 0
for (element in x) total <- total + element
total


## -----------------------------------------------------------------------------
x <- 1:5
total <- 0
for (index in seq_along(x)) {
    element <- x[index]
    total <- total + element
} 
total


## -----------------------------------------------------------------------------
x <- 1:5
total <- 0
index <- 1
while (index <= length(x)) {
    element <- x[index]
    index <- index + 1
    total <- total + element
} 
total


## -----------------------------------------------------------------------------
x <- 1:5
total <- 0
index <- 1
repeat {
  element <- x[index]
  total <- total + element
  index <- index + 1
  if (index > length(x)) break
}
total


## ---- echo=FALSE--------------------------------------------------------------
rm(x)
rm(total)
rm(element)
rm(index)
rm(maybe_square)


## -----------------------------------------------------------------------------
f <- factor(c("small", "small", "medium", 
              "large", "small", "large"))
f


## -----------------------------------------------------------------------------
levels(f)


## -----------------------------------------------------------------------------
ff <- factor(c("small", "small", "medium", 
               "large", "small", "large"),
             levels = c("small", "medium", "large"))
ff


## -----------------------------------------------------------------------------
summary(f)
summary(ff)


## -----------------------------------------------------------------------------
of <- factor(c("small", "small", "medium", 
               "large", "small", "large"),
             levels = c("small", "medium", "large"),
             ordered = TRUE)
of


## -----------------------------------------------------------------------------
ordered(ff)
ordered(f, levels = c("small", "medium", "large"))


## -----------------------------------------------------------------------------
f
f == "small"


## -----------------------------------------------------------------------------
v <- c(a = 1, b = 2, c = 3, d = 4)
v


## -----------------------------------------------------------------------------
v <- 1:4
names(v) <- letters[1:4]
v


## -----------------------------------------------------------------------------
v[2:3]
v[c("b", "c")]


## -----------------------------------------------------------------------------
v[c(3, 2)]


## -----------------------------------------------------------------------------
v[c("c", "b")]


## -----------------------------------------------------------------------------
v[c("c", "b", "c")]


## -----------------------------------------------------------------------------
v <- 1:4
names(v) <- LETTERS[1:4]
v
(ff <- factor(LETTERS[1:4]))
v[ff]


## -----------------------------------------------------------------------------
(ff <- factor(LETTERS[1:4], levels = rev(LETTERS[1:4])))
v[ff]


## -----------------------------------------------------------------------------
as.numeric(ff)


## -----------------------------------------------------------------------------
as.vector(ff)
v[as.vector(ff)]


## ---- echo=FALSE--------------------------------------------------------------
rm(v)
rm(ff)


## -----------------------------------------------------------------------------
df <- data.frame(a = 1:4, b = letters[1:4])
df


## -----------------------------------------------------------------------------
df[1,1]


## -----------------------------------------------------------------------------
df[1,]
df[,1]


## -----------------------------------------------------------------------------
df[,"a"]


## -----------------------------------------------------------------------------
df$b


## -----------------------------------------------------------------------------
data.frame(a = 1:4, b = letters[1:4], 
           stringsAsFactors = TRUE)


## -----------------------------------------------------------------------------
df2 <- data.frame(a = 5:7, b = letters[5:7])
rbind(df, df2)

df3 <- data.frame(c = 5:8, d = letters[5:8])
cbind(df, df3)


## -----------------------------------------------------------------------------
library(tibble)


## -----------------------------------------------------------------------------
library(tidyverse)


## -----------------------------------------------------------------------------
tibble(a = 1:4, b = letters[1:4])


## ---- echo=FALSE--------------------------------------------------------------
rm(df, df2, df3)


## -----------------------------------------------------------------------------
library(magrittr)


## -----------------------------------------------------------------------------
NA + 5
NA == NA
NA != NA


## -----------------------------------------------------------------------------
is.na(NA)
is.na(4)


## -----------------------------------------------------------------------------
v <- c(1,NA,2)
sum(v)


## -----------------------------------------------------------------------------
sum(v, na.rm = TRUE)


## ---- echo=FALSE--------------------------------------------------------------
rm(v)


## -----------------------------------------------------------------------------
subsample_rows <- function(d, n) {
  rows <- sample(nrow(d), n)
  d[rows,]
}


## -----------------------------------------------------------------------------
d <- data.frame(x = rnorm(100), y = rnorm(100))
d %>% subsample_rows(n = 3)


## -----------------------------------------------------------------------------
d |> subsample_rows(n = 3)


## -----------------------------------------------------------------------------
d <- data.frame(x = rnorm(10), y = rnorm(10))
d %>% lm(y ~ x, data = .)


## -----------------------------------------------------------------------------
my_lm <- function(d) lm(y ~ x, data = d)
d |> my_lm()


## -----------------------------------------------------------------------------
d |> (function(d) lm(y ~ x, data = d))()


## -----------------------------------------------------------------------------
d |> (\(d) lm(y ~ x, data = d))()


## -----------------------------------------------------------------------------
rnorm(4) %>% data.frame(x = ., is_negative = . < 0)


## -----------------------------------------------------------------------------
rnorm(4) %>% data.frame(x = ., y = abs(.))


## -----------------------------------------------------------------------------
rnorm(4) %>% data.frame(x = sin(.), y = cos(.))


## -----------------------------------------------------------------------------
d <- data.frame(x = rnorm(10), y = 4 + rnorm(10))
d %>% {data.frame(mean_x = mean(.$x), mean_y = mean(.$y))}


## -----------------------------------------------------------------------------
d %$% data.frame(mean_x = mean(x), mean_y = mean(y))

